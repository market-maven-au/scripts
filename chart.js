"use strict";(()=>{function y(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}async function h(t){try{let e=await fetch(t),o=e.headers.get("Content-Type");if(!e.ok)throw new Error(`Network response was not ok: ${e.statusText}`);if(!o||!o.includes("text/csv"))throw new Error(`Expected text/csv but received ${o}`);return await e.text()}catch(e){throw console.error(`Failed to fetch data from ${t}:`,e),e}}function m(t){let e=t.trim().split(`
`),o=e[0].split(",");return{data:e.slice(1).map(i=>{let s=i.split(",");return o.reduce((a,l,c)=>(a[l]=s[c],a),{})}),headers:o}}function C(t){let e=t.data.map(i=>i[t.headers[0]]),o=t.data.map(i=>parseFloat(i[t.headers[1]].replace("$","").replace(",",""))),n=t.data.map(i=>t.headers.slice(2).map(s=>`${s}: ${i[s]}`).join(", "));return{labels:e,values:o,tooltips:n}}function g(t){let e=Date.parse(t);return!isNaN(e)||t.includes(":")}function x(t,e,o,n,i){let s={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",titleFont:{family:"'Clarity City', sans-serif",size:14},bodyColor:"#fff",bodyFont:{family:"'Clarity City', sans-serif",size:14},usePointStyle:!1,displayColors:!1,callbacks:{label:function(r){let f=r.raw;return`${i.headers[1]}: ${y(f)}`},afterLabel:function(r){return i.headers.length<=2?"":n[r.dataIndex].split(", ").map(d=>{let[u,p]=d.split(": ");return`${u.trim()}: ${y(p?p.trim():"")}`}).join(chartOptions.type==="line"?`
`:", ")}}},title:{display:!0,text:chartOptions.titleText,font:{family:"'Clarity City', sans-serif",size:16},color:"#333"}}},a={...s,scales:{x:g(e[0])?{type:"time",time:{parser:"dd/MM/yyyy HH:mm",tooltipFormat:"dd MMMM yyyy",unit:"month",displayFormats:{day:"MMM yy"}},grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{font:{family:"'Clarity City', sans-serif",size:14},color:"#333",autoSkip:!0,maxTicksLimit:Math.ceil(e.length/12)*4}}:{grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{font:{family:"'Clarity City', sans-serif",size:14},color:"#333",autoSkip:!0,maxTicksLimit:Math.ceil(e.length/12)*4}},y:{grid:{display:!1},ticks:{font:{family:"'Clarity City', sans-serif",size:14},color:"#333",callback:function(r){return r>=1e9?Math.round(r/1e9)+"B":r>=1e6?Math.round(r/1e6)+"M":y(Math.round(r))}},title:{display:!0,text:chartOptions.axisTitle,font:{family:"'Clarity City', sans-serif",size:14},color:"#333"}}}},l={...s,indexAxis:"y",scales:{y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{font:{family:"'Clarity City', sans-serif",size:14},color:"#333",autoSkip:!1}},x:{grid:{display:!1},ticks:{font:{family:"'Clarity City', sans-serif",size:14},color:"#333",callback:function(r){return r>=1e9?Math.round(r/1e9)+"B":r>=1e6?Math.round(r/1e6)+"M":r>=1e3?Math.round(r/1e3)+"K":Math.round(r)}},title:{display:!0,text:chartOptions.axisTitle,font:{family:"'Clarity City', sans-serif",size:14},color:"#333"}}}},c={type:chartOptions.type,data:{labels:e,datasets:[{label:i.headers[1],data:o,backgroundColor:"rgba(0, 0, 0, 1)",borderColor:"rgba(0, 0, 0, 1)",borderWidth:chartOptions.type==="line"?3:1,tension:chartOptions.type==="line"?.4:0}]},options:chartOptions.type==="line"?a:l};return new Chart(t,c)}async function b(){try{let t=await h(chartOptions.txtUrl),e=m(t),{labels:o,values:n,tooltips:i}=C(e),s=document.getElementById("blogChart").getContext("2d");x(s,o,n,i,e)}catch(t){console.error("Error:",t)}}b();})();
