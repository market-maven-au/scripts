"use strict";(()=>{function c(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function d(t,r){return t>=1e9?r.roundNumbers?(t/1e9).toFixed(2)+"b":t/1e9+"b":t>=1e6?r.roundNumbers?(t/1e6).toFixed(2)+"m":t/1e6+"m":t>=1e3?r.roundNumbers?(t/1e3).toFixed(2)+"k":t/1e3+"k":r.roundNumbers?t.toFixed(2):t}async function f(t){try{let r=await fetch(t),e=r.headers.get("Content-Type");if(!r.ok)throw new Error(`Network response was not ok: ${r.statusText}`);if(!e||!e.includes("text/csv"))throw new Error(`Expected text/csv but received ${e}`);return await r.text()}catch(r){throw console.error(`Failed to fetch data from ${t}:`,r),r}}function m(t){let r=t.trim().split(`
`),e=r[0].split(",");return{data:r.slice(1).map(n=>{let i=n.split(",");return e.reduce((a,s,l)=>(a[s]=i[l],a),{})}),headers:e}}function y(t){let r=t.data.map(n=>n[t.headers[0]]),e=t.data.map(n=>parseFloat(n[t.headers[1]].replace("$","").replace(",",""))),o=t.data.map(n=>t.headers.slice(2).map(i=>`${i}: ${n[i]}`).join(", "));return{labels:r,values:e,tooltips:o}}function b(t){let r=Date.parse(t);return!isNaN(r)||t.includes(":")}function x(t,r,e,o,n,i){Chart.defaults.font.family="'Clarity City', sans-serif",Chart.defaults.font.size=14;let a=g(o,n,i),s=p(r,a,i),l=M(n,e,i),u={type:i.type==="column"?"bar":i.type,data:{labels:r,datasets:l},options:{...a,...s}};return new Chart(t,u)}function g(t,r,e){return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",titleFont:{size:14},bodyColor:"#fff",bodyFont:{size:14},usePointStyle:!1,displayColors:!1,callbacks:{label:function(o){let n=o.raw,i=e.roundNumbers?d(n,e):c(n);return`${o.dataset.label.trim()}: ${e.isDollarValue?"$":""}${i}`},afterLabel:function(o){return e.multiSeries||r.headers.length<=2?"":t[o.dataIndex].split(", ").map(i=>{let[a,s]=i.split(": ");return`${a.trim()}: ${c(s?e.roundNumbers?d(parseFloat(s.trim()),e):s.trim():"")}`}).join(e.type==="line"?`
`:", ")}}},title:{display:!0,text:e.titleText,font:{size:16},color:"#333"}}}}function p(t,r,e){switch(e.type){case"line":return k(t,r,e);case"bar":return C(r,e);case"column":return h(r,e);default:return{}}}function k(t,r,e){return{...r,interaction:{mode:"nearest",intersect:!1,axis:"xy"},scales:{x:b(t[0])?{type:"time",time:{parser:"dd/MM/yyyy HH:mm",tooltipFormat:"dd MMMM yyyy",unit:"month",displayFormats:{day:"MMM yy"}},grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{color:"#333",autoSkip:!0,maxTicksLimit:Math.ceil(t.length/12)*4}}:{grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{color:"#333",autoSkip:!0,maxTicksLimit:Math.ceil(t.length/12)*4}},y:{grid:{display:!1},ticks:{color:"#333",callback:function(o){let n;return o>=1e9?n=Math.round(o/1e9)+"b":o>=1e6?n=Math.round(o/1e6)+"m":n=c(Math.round(o)),e.isDollarValue?"$"+n:n}},title:{display:e.showAxisTitle,text:e.axisTitle,color:"#333"}}}}}function C(t,r){return{...t,interaction:{mode:"nearest",intersect:!1,axis:"y"},indexAxis:"y",scales:{x:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{color:"#333",callback:function(e){let o;return e>=1e9?o=Math.round(e/1e9)+"b":e>=1e6?o=Math.round(e/1e6)+"m":e>=1e3?o=Math.round(e/1e3)+"k":o=Math.round(e),r.isDollarValue?"$"+o:o}},title:{display:r.showAxisTitle,text:r.axisTitle,color:"#333"}},y:{grid:{display:!1},ticks:{color:"#333",autoSkip:!1},title:{display:!1}}}}}function h(t,r){return{...t,interaction:{mode:"nearest",intersect:!1,axis:"xy"},indexAxis:"x",scales:{x:{grid:{display:!1},ticks:{color:"#333",autoSkip:!1},title:{display:!1}},y:{beginAtZero:!0,grid:{color:"rgba(0, 0, 0, 0.1)"},ticks:{color:"#333",callback:function(e){let o;return e>=1e9?o=Math.round(e/1e9)+"b":e>=1e6?o=Math.round(e/1e6)+"m":e>=1e3?o=Math.round(e/1e3)+"k":o=Math.round(e),r.isDollarValue?"$"+o:o}},title:{display:r.showAxisTitle,text:r.axisTitle,color:"#333"}}}}}function M(t,r,e){return e.multiSeries?t.headers.slice(1).map((o,n)=>({label:o,data:t.data.map(i=>parseFloat(i[o].replace("$","").replace(",",""))),backgroundColor:e.colorPalette[n%e.colorPalette.length],borderColor:e.colorPalette[n%e.colorPalette.length],borderWidth:e.type==="line"?3:1,tension:e.type==="line"?.4:0})):[{label:t.headers[1],data:r,backgroundColor:"rgba(0, 0, 0, 1)",borderColor:"rgba(0, 0, 0, 1)",borderWidth:e.type==="line"?3:1,tension:e.type==="line"?.4:0}]}async function w(t,r){try{let e=await f(t.txtUrl),o=m(e),{labels:n,values:i,tooltips:a}=y(o),s=document.getElementById(r).getContext("2d");x(s,n,i,a,o,t)}catch(e){console.error("Error:",e)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("canvas[data-chart-options]").forEach(r=>{let e=JSON.parse(r.getAttribute("data-chart-options"));w(e,r.id)})});})();
